<link rel="import" href="bower_components/polymer/polymer-element.html">
<link rel="import" href="bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="bower_components/polymer/lib/utils/render-status.html">

<dom-module id="cryptoprice-dash">
	<template>
		<h2>Hello</h2>
		<iron-ajax id='coinbase' handle-as="json" on-response="_handleResponse"></iron-ajax>
	</template>
	<script>
		class CryptopriceDash extends Polymer.Element {
			static get is() { return 'cryptoprice-dash' }
			static get properties() {
				return{
					currencies:{
						type: Array,
						value: [{
							code:'5b71fc48-3dd3-540c-809b-f8c94d0e68b5',
							name: 'Bitcoin'
						},{
							code:'d85dce9b-5b73-5c3c-8978-522ce1d1c1b4',
							name: 'Ethereum'
						}, {
							code: 'c9c24c6e-c045-5fde-98a2-00ea7f520437',
							name: 'Litecoin'
						}]
					}
				}
			}

			ready(){
				super.ready();
				Polymer.RenderStatus.afterNextRender(this, function() {
				 	this._getCurrencyData();
				})
			}

			_getCurrencyData(){
				var ajax= this.$.coinbase

				this.currencies.forEach((element) => {
					ajax.url =  'https://www.coinbase.com/api/v2/assets/prices/' + element.code + '?base=EUR';
					ajax.generateRequest();
				});
			}

			_handleResponse(response){
				console.log(response);
			}
		}
		window.customElements.define(CryptopriceDash.is, CryptopriceDash);
	</script>

</dom-module>

<!--
	GET
// https://www.coinbase.com/api/v2/assets/info?&locale=es&country=ES&filter=listed



https://www.coinbase.com/api/v2/assets/prices/d85dce9b-5b73-5c3c-8978-522ce1d1c1b4?base=EUR


-->